### [1396. Design Underground System](https://leetcode.com/problems/design-underground-system)
```Typescript
/**
 * Your UndergroundSystem object will be instantiated and called as such:
 * var obj = new UndergroundSystem()
 * obj.checkIn(id,stationName,t)
 * obj.checkOut(id,stationName,t)
 * var param_3 = obj.getAverageTime(startStation,endStation)
 */
```
#### Brute Force
```Typescript
class UndergroundSystem {

  travelRecord: Map<number, [string, number]>;
  travelTime: Map<string, Map<string, number[]>>;

  constructor() {
    this.travelRecord = new Map();
    this.travelTime = new Map();
  }

  checkIn(id: number, stationName: string, t: number): void {
    this.travelRecord.set(id, [stationName, t]);
  }

  checkOut(id: number, endStation: string, endTime: number): void {
    const [startStation, startTime] = this.travelRecord.get(id);
    this.travelRecord.delete(id);
    if (!this.travelTime.has(startStation)) {
      this.travelTime.set(startStation, new Map());
    }
    const startStationMap = this.travelTime.get(startStation);
    if (!startStationMap.has(endStation)) {
      startStationMap.set(endStation, []);
    }
    const endStationList = startStationMap.get(endStation);
    endStationList.push(endTime - startTime);
  }

  getAverageTime(startStation: string, endStation: string): number {
    const timeList = this.travelTime.get(startStation).get(endStation);
    return timeList.reduce((a, b) => a + b) / timeList.length;
  }
}
```
#### Clean Code
```Typescript
class UndergroundSystem {
  private checkIns = new Map<number, [string, number]>();
  private travelStats = new Map<string, Map<string, [number, number]>>();

  checkIn(id: number, stationName: string, t: number): void {
    this.checkIns.set(id, [stationName, t]);
  }

  checkOut(id: number, endStation: string, endTime: number): void {
    const [startStation, startTime] = this.checkIns.get(id)!;
    this.checkIns.delete(id);

    const duration = endTime - startTime;
    if (!this.travelStats.has(startStation)) {
      this.travelStats.set(startStation, new Map());
    }

    const endMap = this.travelStats.get(startStation)!;
    const [totalTime, tripCount] = endMap.get(endStation) ?? [0, 0];
    endMap.set(endStation, [totalTime + duration, tripCount + 1]);
  }

  getAverageTime(startStation: string, endStation: string): number {
    const [totalTime, tripCount] = this.travelStats.get(startStation)!.get(endStation)!;
    return totalTime / tripCount;
  }
}
```
```Python3
class UndergroundSystem:
    def __init__(self):
        self.check_ins = {}
        self.travel_stats = {}

    def checkIn(self, id: int, stationName: str, t: int) -> None:
        self.check_ins[id] = (stationName, t)

    def checkOut(self, id: int, endStation: str, endTime: int) -> None:
        startStation, startTime = self.check_ins.pop(id)
        duration = endTime - startTime

        if startStation not in self.travel_stats:
            self.travel_stats[startStation] = {}
        if endStation not in self.travel_stats[startStation]:
            self.travel_stats[startStation][endStation] = [0, 0]

        total_time, trip_count = self.travel_stats[startStation][endStation]
        self.travel_stats[startStation][endStation] = [total_time + duration, trip_count + 1]

    def getAverageTime(self, startStation: str, endStation: str) -> float:
        total_time, trip_count = self.travel_stats[startStation][endStation]
        return total_time / trip_count
```
